# Документация к проекту LMS (Learning Management System)

## Содержание
1. [Введение](#введение)
2. [Архитектура системы](#архитектура-системы)
3. [Основные компоненты](#основные-компоненты)
4. [Модели данных](#модели-данных)
5. [Сервисы](#сервисы)
6. [Аутентификация и безопасность](#аутентификация-и-безопасность)
7. [Управление курсами](#управление-курсами)
8. [Управление заданиями](#управление-заданиями)
9. [Тестирование](#тестирование)
10. [Отслеживание прогресса](#отслеживание-прогресса)
11. [Уведомления](#уведомления)
12. [Установка и запуск](#установка-и-запуск)
13. [Требования к системе](#требования-к-системе)
14. [Устранение неполадок](#устранение-неполадок)

## Введение

LMS (Learning Management System) - это система управления обучением, разработанная для создания, управления и отслеживания образовательных курсов. Система предоставляет функционал для преподавателей, студентов и администраторов, позволяя эффективно организовать учебный процесс.

Основные возможности системы:
- Управление пользователями с разными ролями (студент, преподаватель, администратор)
- Создание и управление курсами
- Создание модулей и различных типов контента (текст, видео, тесты, задания)
- Отслеживание прогресса студентов
- Система оценивания заданий
- Уведомления о важных событиях

## Архитектура системы

Проект разработан на платформе .NET с использованием WPF (Windows Presentation Foundation) для пользовательского интерфейса. Архитектура приложения построена по паттерну MVVM (Model-View-ViewModel), что обеспечивает разделение бизнес-логики и представления.

Основные технологии:
- .NET 8.0
- WPF для пользовательского интерфейса
- Entity Framework Core для работы с базой данных
- PostgreSQL в качестве СУБД
- CommunityToolkit.Mvvm для реализации MVVM-паттерна
- BCrypt.Net для хеширования паролей
- Microsoft.Toolkit.Uwp.Notifications для системных уведомлений

## Основные компоненты

### Модели (Models)
Классы, представляющие сущности системы: пользователи, курсы, модули, контент, задания и т.д.

### Представления (Views)
WPF-окна и элементы управления, отображающие пользовательский интерфейс.

### Модели представлений (ViewModels)
Классы, связывающие модели данных с представлениями и содержащие бизнес-логику.

### Сервисы (Services)
Классы, предоставляющие функциональность для работы с данными и бизнес-логикой.

### Инфраструктура (Infrastructure)
Вспомогательные классы, конвертеры, расширения и другие компоненты.

## Модели данных

### User
Представляет пользователя системы с различными ролями (студент, преподаватель, администратор).

Основные свойства:
- Id - уникальный идентификатор
- Username - имя пользователя
- FirstName, LastName - имя и фамилия
- Email - электронная почта
- Role - роль пользователя (Student, Teacher, Administrator)
- IsActive - статус активности аккаунта
- LastLoginDate - дата последнего входа
- Credentials - учетные данные (пароль, токены и т.д.)
- EnrolledCourses - курсы, на которые записан пользователь
- TeachingCourses - курсы, которые ведет пользователь
- CustomPermissions - дополнительные разрешения

### Course
Представляет учебный курс.

Основные свойства:
- Id - уникальный идентификатор
- Title - название курса
- Description - описание курса
- CreationDate - дата создания
- StartDate, EndDate - даты начала и окончания курса
- TeacherId - идентификатор преподавателя
- Teacher - преподаватель курса
- Students - студенты, записанные на курс
- Modules - модули курса
- AccessType - тип доступа к курсу (Open, Invitation, Closed)

### Module
Представляет модуль курса - логическую группу учебных материалов.

Основные свойства:
- Id - уникальный идентификатор
- Title - название модуля
- Description - описание модуля
- OrderIndex - порядковый номер в курсе
- CourseId - идентификатор курса
- Contents - содержимое модуля

### Content
Представляет учебный материал в модуле.

Основные свойства:
- Id - уникальный идентификатор
- Title - название
- Type - тип контента (Text, Video, Quiz, Assignment)
- Data - содержимое (зависит от типа)
- OrderIndex - порядковый номер в модуле
- ModuleId - идентификатор модуля

### Assignment
Представляет задание для студентов.

Основные свойства:
- Id - уникальный идентификатор
- CourseId - идентификатор курса
- Title - название задания
- Description - описание задания
- CreatedDate - дата создания
- DueDate - срок сдачи
- MaxScore - максимальный балл
- RequiresFileUpload - требуется ли загрузка файлов
- AllowedFileExtensions - разрешенные расширения файлов
- MaxFileSize - максимальный размер файла
- AllowLateSubmissions - разрешены ли поздние ответы
- LatePenaltyPerDay - штраф за опоздание (в процентах)
- Criteria - критерии оценивания
- Submissions - ответы студентов

### Quiz
Представляет тест для проверки знаний.

Основные свойства:
- Id - уникальный идентификатор
- ContentId - идентификатор связанного контента
- Title - название теста
- Description - описание теста
- TimeLimit - ограничение по времени
- PassingScore - проходной балл
- RandomizeQuestions - случайный порядок вопросов
- ShowCorrectAnswers - показывать ли правильные ответы
- Questions - вопросы теста

## Сервисы

### AuthenticationService
Сервис для аутентификации пользователей.

Основные методы:
- AuthenticateAsync - аутентификация пользователя
- ChangePasswordAsync - изменение пароля
- GeneratePasswordResetTokenAsync - генерация токена для сброса пароля
- ResetPasswordAsync - сброс пароля с использованием токена
- HashPassword - хеширование пароля
- VerifyPassword - проверка пароля

### UserService
Сервис для работы с пользователями.

Основные методы:
- GetUserByIdAsync - получение пользователя по ID
- GetAllUsersAsync - получение всех пользователей
- GetUsersByRoleAsync - получение пользователей по роли
- CreateUserAsync - создание пользователя
- UpdateUserAsync - обновление пользователя
- DeleteUserAsync - удаление пользователя
- SetCurrentUserAsync - установка текущего пользователя

### CourseService
Сервис для работы с курсами.

Основные методы:
- GetCoursesAsync - получение списка курсов
- GetCourseAsync - получение курса по ID
- CreateCourseAsync - создание курса
- UpdateCourseAsync - обновление курса
- DeleteCourseAsync - удаление курса
- AddModuleAsync - добавление модуля в курс
- AddContentAsync - добавление контента в модуль
- EnrollStudentAsync - запись студента на курс
- GetStudentProgressAsync - получение прогресса студента
- GetCourseStatisticsAsync - получение статистики по курсу
- GetAssignmentsAsync - получение заданий курса
- GetSubmissionsAsync - получение ответов на задания

### AuditService
Сервис для аудита действий пользователей.

Основные методы:
- LogActionAsync - логирование действия
- LogRoleChangeAsync - логирование изменения роли
- LogPermissionChangeAsync - логирование изменения разрешений
- GetUserRoleHistoryAsync - получение истории изменений ролей
- GetUserPermissionHistoryAsync - получение истории изменений разрешений
- GetUserActionsAsync - получение действий пользователя

### NotificationService
Сервис для работы с уведомлениями.

Основные методы:
- InitializeAsync - инициализация сервиса
- Start - запуск сервиса
- Stop - остановка сервиса
- SendNotificationAsync - отправка уведомления
- UpdateSettingsAsync - обновление настроек уведомлений

## Аутентификация и безопасность

Система использует надежные механизмы аутентификации и защиты данных:

1. **Хеширование паролей** - пароли хранятся в виде хешей с использованием алгоритма PBKDF2 или BCrypt
2. **Блокировка аккаунта** - после нескольких неудачных попыток входа аккаунт временно блокируется
3. **Сброс пароля** - механизм сброса пароля через токен
4. **Аудит действий** - все важные действия пользователей логируются
5. **Система разрешений** - детальная настройка прав доступа для пользователей
6. **Валидация паролей** - проверка сложности пароля при регистрации и смене

## Управление курсами

Система позволяет преподавателям создавать и управлять курсами:

1. **Создание курса** - указание названия, описания, дат начала и окончания
2. **Добавление модулей** - структурирование материала по модулям
3. **Добавление контента** - различные типы учебных материалов:
   - Текстовые материалы
   - Видеоматериалы
   - Тесты
   - Задания
4. **Управление доступом** - настройка типа доступа к курсу
5. **Отслеживание прогресса** - мониторинг успеваемости студентов

## Управление заданиями

Преподаватели могут создавать задания и оценивать работы студентов:

1. **Создание задания** - указание названия, описания, срока сдачи, максимального балла
2. **Настройка критериев оценивания** - детальные критерии для объективной оценки
3. **Проверка работ** - интерфейс для проверки и оценивания ответов студентов
4. **Обратная связь** - возможность оставлять комментарии к работам
5. **Массовое оценивание** - функция для быстрой оценки нескольких работ

Студенты могут:
1. **Просматривать задания** - доступ к описанию и требованиям
2. **Отправлять ответы** - текстовые ответы и/или файлы
3. **Сохранять черновики** - возможность сохранить незавершенную работу
4. **Видеть оценки и комментарии** - получение обратной связи от преподавателя

## Тестирование

Система позволяет создавать и проходить тесты:

1. **Создание теста** - настройка параметров теста (время, проходной балл и т.д.)
2. **Добавление вопросов** - различные типы вопросов:
   - С одним вариантом ответа
   - С несколькими вариантами ответа
   - Верно/неверно
   - С коротким ответом
   - С развернутым ответом
3. **Прохождение теста** - интерфейс для студентов с таймером и навигацией
4. **Автоматическая проверка** - мгновенная оценка тестов с закрытыми вопросами
5. **Просмотр результатов** - отображение оценки и правильных ответов

## Отслеживание прогресса

Система предоставляет инструменты для мониторинга успеваемости:

1. **Прогресс по курсу** - общий процент выполнения курса
2. **Прогресс по модулям** - детализация по модулям
3. **Статистика по заданиям** - оценки и сроки выполнения
4. **Статистика по тестам** - результаты и попытки
5. **Отчеты для преподавателей** - сводная информация по группе студентов

## Уведомления

Система уведомляет пользователей о важных событиях:

1. **Приближающиеся дедлайны** - напоминания о сроках сдачи
2. **Пропущенные дедлайны** - уведомления о просроченных заданиях
3. **Оценки за задания** - информация о выставленных оценках
4. **Новые задания** - уведомления о новых заданиях
5. **Комментарии** - уведомления о новых комментариях

Настройки уведомлений позволяют:
- Включать/отключать уведомления
- Настраивать звуковые сигналы
- Устанавливать "тихие часы"
- Выбирать способы доставки уведомлений

## Установка и запуск

### Требования к системе
- Windows 10 или выше
- .NET 8.0 Runtime
- PostgreSQL 12 или выше
- 4 ГБ оперативной памяти (рекомендуется)
- 500 МБ свободного места на диске

### Шаги по установке

1. **Установка PostgreSQL**
   - Скачайте и установите PostgreSQL с официального сайта
   - Создайте базу данных с именем "lms"
   - Создайте пользователя с именем "postgres" и паролем "postgres" (или измените настройки подключения в appsettings.json)

2. **Настройка приложения**
   - Распакуйте архив с приложением в выбранную директорию
   - Отредактируйте файл appsettings.json, указав параметры подключения к базе данных:
     ```json
     {
       "ConnectionStrings": {
         "DefaultConnection": "Host=localhost;Database=lms;Username=postgres;Password=postgres"
       },
       "Storage": {
         "AssignmentFiles": "Files/Assignments"
       },
       "Notifications": {
         "Enabled": true,
         "CheckInterval": 5
       }
     }
     ```

3. **Первый запуск**
   - Запустите приложение WpfApp1.exe
   - При первом запуске будет создана структура базы данных и добавлен администратор по умолчанию
   - Учетные данные администратора по умолчанию:
     - Логин: admin
     - Пароль: Admin123!

### Миграция базы данных

Если требуется обновить структуру базы данных:

1. Откройте командную строку в директории с приложением
2. Выполните команду:
   ```
   dotnet ef migrations add InitialMigration
   dotnet ef database update
   ```

## Устранение неполадок

### Проблемы с подключением к базе данных
- Проверьте, запущен ли сервер PostgreSQL
- Убедитесь, что параметры подключения в appsettings.json указаны верно
- Проверьте, что пользователь имеет права на доступ к базе данных

### Проблемы с аутентификацией
- Если вы забыли пароль администратора, используйте функцию сброса пароля
- При блокировке аккаунта подождите 30 минут или обратитесь к администратору

### Проблемы с загрузкой файлов
- Убедитесь, что директория для хранения файлов (указанная в appsettings.json) существует и доступна для записи
- Проверьте, что размер загружаемого файла не превышает установленный лимит

### Логирование ошибок
- Журналы ошибок сохраняются в директории logs
- При обращении в поддержку предоставьте файлы журналов для анализа

### Общие рекомендации
- Регулярно создавайте резервные копии базы данных
- Обновляйте приложение до последней версии
- При возникновении проблем перезапустите приложение

## Заключение

LMS предоставляет полный набор инструментов для организации учебного процесса. Система постоянно развивается, добавляются новые функции и улучшается пользовательский опыт. Если у вас есть предложения по улучшению или вы обнаружили ошибку, пожалуйста, сообщите об этом разработчикам.
